# Read in csv

```{r}
data <- read.csv("CA1_Autism_VR_Study_Data_Final.csv")

# Data inspect
head(data)
colnames(data)
```

# Q1. Determine whether the data provided are appropriate for the test(s) available and whether any data cleaning is required.

What do we need to consider:
- Confirm study consisted of 300 patients (M=150, F=150)
- Confirm each group 100 people
- Confirm CBT Group (M=53, F=47)
- Confirm Experimental (VR-based therapy) (M=48, F=52)
- Confirm Control (no CBT, no VR) (M=59, F=41)
- Confirm there is no missed data in any of the rows 

```{r}
# Overall sense check
dim(data)
str(data)
summary(data)
```
```{r}
# Confirm gender distribution (M=150, F=150)
table(data$Gender)

# Confirm group distribution
table(data$Group)

# Confirm gender distribution by group
print(table(data$Gender[data$Group == "CBT"]))
print(table(data$Gender[data$Group == "VR"]))
print(table(data$Gender[data$Group == "Control"]))

```
```{r}
# Check for missing data
sum(is.na(data))
sum(complete.cases(data))
```

- Confirm all of the AQ scores are between 0-50
- Check all of the "Change_Score" = P1_Pre_Score" - "P2_Post_Score"
- Confirm no repeated ids

```{r}
cat(range(data$P1_Pre_Score), "\n")
cat(range(data$P2_Post_Score), "\n")
```

```{r}
calculated_change <- data$P1_Pre_Score - data$P2_Post_Score
correct <- sum(data$Change_Score == calculated_change)
print(correct)
```

```{r}
duplicates <- sum(duplicated(data[[id_column]]))
print(duplicates)
```

## Overview
- The gender distribution of the entire dataset does not match, spec said (M=150, F=150), in actually (M=160, F=140).
- The gender distribution for each group CBT, VR and Control does does spec (M=53, F=47), (M=48, F=52) and (M=59, F=41).
- Confused by the scoring ? need to check with lecturer

# Q2: Formulate three hypothesis tests to be used to compare the effectiveness of the approaches used during the experiment.

Hypothesis Test 1 – Comparison Across All Three Groups
H0: The three groups (CBT, VR, Control) have equal mean Change_Score.
H1: At least one group has a different mean Change_Score.

```{r}
# 0) Check how many people used each of the therapies and control
print(table(data$Group))
# 1) Calculate mean for therapy and mean for control
mean_cbt <- mean(data$Change_Score[data$Group == "CBT"], na.rm = TRUE)
mean_vr <- mean(data$Change_Score[data$Group == "VR"], na.rm = TRUE)
mean_control <- mean(data$Change_Score[data$Group == "Control"], na.rm = TRUE)

cat("Mean CBT:", round(mean_cbt, 3), "\n")
cat("Mean VR:", round(mean_vr, 3), "\n")
cat("Mean Control:", round(mean_control, 3), "\n")

```
## Overview
-The distribution of the therapies is: CBT = 100 participants, VR = 100 participants, Control = 100 participants.
-The mean improvement for the group CBT is 10.16, the mean improvement for the VR group is 19.43 and the mean improvement for the Control group is 0.01.
-This shows that participants who received VR and CBT treatments improved more than those who received no treatment.
-This supports the hypothesis that that participants who received CBT or VR improved much more than those who received no treatment in this dataset.


-----------------------------------------------------------------------------------------

Hypothesis Test 2 – Any Therapy vs Control
H0: The mean Change_Score for participants receiving a therapy (CBT or VR) is equal to the mean for the Control group.
H1: Participants receiving a therapy show greater improvement than the Control group.


```{r}
# 1) Create the column TherapyGroup with values Control (Control) and Therapy (CBT or VR)
data$TherapyGroup <- ifelse(data$Group == "Control", "Control", "Therapy")
print(table(data$TherapyGroup))

# 2) Calculate mean for therapy and mean for control
mean_therapy <- mean(data$Change_Score[data$TherapyGroup == "Therapy"], na.rm = TRUE)
mean_control <- mean(data$Change_Score[data$TherapyGroup == "Control"], na.rm = TRUE)

cat("Mean Therapy:", round(mean_therapy, 3), "\n")
cat("Mean Control:", round(mean_control, 3), "\n")

```
## Overview
-A new variable TherapyGroup was created to compare participants who received any therapy (CBT or VR) with those in the Control group.
-The distribution of the new groups is: Therapy = 200 participants, Control = 100 participants.
-The mean improvement (Change_Score) for the Therapy group is 14.795, while the mean improvement for the Control group is 02.01.
-This shows that participants who received CBT or VR improved much more than those who received no treatment in this dataset.

-----------------------------------------------------------------------------------------

Hypothesis Test 3 – CBT vs VR
H0: The mean improvement (Change_Score) is the same for the CBT and VR groups.
H1: The mean improvement differs between CBT and VR.

```{r}
# 0) Check how many people used each of the therapies
print(table(data$Group))
# 1) Calculate mean for therapy and mean for control
mean_cbt <- mean(data$Change_Score[data$Group == "CBT"], na.rm = TRUE)
mean_vr <- mean(data$Change_Score[data$Group == "VR"], na.rm = TRUE)

cat("Mean CBT:", round(mean_cbt, 3), "\n")
cat("Mean VR:", round(mean_vr, 3), "\n")

```
## Overview
-The distribution of the therapies is: CBT = 100 participants, VR = 100 participants.
-The mean improvement for the group CBT is 10.16, while the mean improvement for the VR group is 19.43.
-This shows that participants who received VR improved more than those who received no CBT treatment.
-This supports the hypothesis that the two therapies differ in effectiveness, with VR performing better in this dataset.

# Q3: Determine if the data meet the assumptions required by any statistical test.
```{r}
# Normality
par(mfrow = c(1, 3))
hist(data$Change_Score[data$Group == "CBT"], 
     main = "CBT Group", 
     xlab = "Change Score",
     col = "lightblue")

hist(data$Change_Score[data$Group == "VR"], 
     main = "VR Group", 
     xlab = "Change Score",
     col = "lightgreen")

hist(data$Change_Score[data$Group == "Control"], 
     main = "Control Group", 
     xlab = "Change Score",
     col = "lightcoral")
par(mfrow = c(1, 1))

```

```{r}
# Normality 0.05 check - If p > 0.05, data is normal

shapiro.test(data$Change_Score[data$Group == "CBT"])
shapiro.test(data$Change_Score[data$Group == "VR"])
shapiro.test(data$Change_Score[data$Group == "Control"])

```

```{r}
# Variances and standard deviations - If SDs are similar, variances are equal

sd_cbt <- sd(data$Change_Score[data$Group == "CBT"])
sd_vr <- sd(data$Change_Score[data$Group == "VR"])
sd_control <- sd(data$Change_Score[data$Group == "Control"])

cat("Variances:\n")
cat("CBT:", round(var(data$Change_Score[data$Group == "CBT"]), 2), "\n")
cat("VR:", round(var(data$Change_Score[data$Group == "VR"]), 2), "\n")
cat("Control:", round(var(data$Change_Score[data$Group == "Control"]), 2), "\n\n")

cat("Standard Deviations:\n")
cat("CBT:", round(sd_cbt, 2), "\n")
cat("VR:", round(sd_vr, 2), "\n")
cat("Control:", round(sd_control, 2), "\n")
```

```{r}
# Box plots for outliers
boxplot(Change_Score ~ Group, data = data,
        main = "Change Score by Group",
        xlab = "Group",
        ylab = "Change Score",
        col = c("lightblue", "lightcoral", "lightgreen"))
```

```{r}
outliers <- function(x) {
  Q1 <- quantile(x, 0.25)
  Q3 <- quantile(x, 0.75)
  IQR_val <- Q3 - Q1
  lower <- Q1 - 1.5 * IQR_val
  upper <- Q3 + 1.5 * IQR_val
  sum(x < lower | x > upper)
}

cat("Number of Outliers:\n")
cat("CBT:", outliers(data$Change_Score[data$Group == "CBT"]), "\n")
cat("VR:", outliers(data$Change_Score[data$Group == "VR"]), "\n")
cat("Control:", outliers(data$Change_Score[data$Group == "Control"]), "\n\n")
        col = c("lightblue", "lightcoral", "lightgreen")
```

## Overview
The above tests demonstrated the suitability of the data to meet the assumptions required by statistical test
- The change score feature for each group is approx symetrical and normally distributed (bell shaped). These visual assessments support the use of parametric statistical tests.
- Statistical test for normality (p > 0.05 = normal) which is demonstrated with CBT: p = 0.3543 and VR: p = 0.3092 groups meeting the assumption of normality however produced the result of Control: p = 0.0188. Given the large sample size n = 100 and robustness of the mentioned statistical tests given priority of over assumptions, the data remains appropriate.
- Its necessary that the groups have a similar spread deduced by the varience and SD tests. Variances: CBT = 20.36, VR = 31.1, Control = 19.81. SDs: CBT = 4.51, VR = 5.58, Control = 4.45. The largest standard deviation was less than twice the smallest (x1.25), determining adequate results indicating equal variances. Therefore homogeneity in dataset was met.
- Outliers and extreme values in dataset should ideally be avoided. The VR group shows the highest median improvement (~19), followed by CBT (~10), while the Control group shows minimal change (~0). The boxplots reveal no extreme outliers beyond 1.5 times the interquartile range in any group. THis is further confirmed with the outlier count following this.

The data met the key assumptions for the statistical tests.

# Q4: Provide descriptive statistics (graphs and tables) for any assumptions made.
The graphs supporting the assumptions made were porvided above. The remaining details can be described below in the descriptive statistics table.
```{r}
library(dplyr)

desc_stats <- data %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    Mean = round(mean(Change_Score), 2),
    SD = round(sd(Change_Score), 2),
    Median = median(Change_Score),
    Min = min(Change_Score),
    Max = max(Change_Score)
  )

print("Table 1: Descriptive Statistics by Group")
print(desc_stats)
```
# Q5: Analyze the data to provide the hypothesis testing conclusion..
Hypothesis Test 1 – Comparison Across All Three Groups

Conclusion:
The VR group shows the highest improvement, followed by CBT, while the Control group shows almost no improvement.
These large differences in mean Change_Score indicate that at least one group differs substantially from the others, supporting the alternative hypothesis that the three groups do not have equal mean improvement.

Hypothesis Test 2 – Any Therapy vs Control

Conclusion:
Participants receiving CBT or VR improved far more than the Control group.
The large difference in mean Change_Score strongly supports the hypothesis that therapy produces greater improvement than receiving no treatment.

Hypothesis Test 3 – CBT vs VR

Conclusion:
VR produced considerably higher improvement than CBT.
This supports the hypothesis that the two therapies differ in effectiveness, with VR performing better in this dataset.

# Q6: Determine the 95% confidence interval for the population mean of a single group.

Choose a group: "CBT", "VR", or "Control" in this Case CBT

```{r}
group <- "CBT"

values <- data$Change_Score[data$Group == group]

mean_val <- mean(values)
sd_val <- sd(values)
n <- length(values)

se <- sd_val / sqrt(n)
lower <- mean_val - 1.96 * se
upper <- mean_val + 1.96 * se

cat("95% Confidence Interval for", group, ":\n")
cat("Mean =", round(mean_val, 2), "\n")
cat("CI =", round(lower, 2), "to", round(upper, 2), "\n")
```

## Overview
For the CBT group:

Mean Change_Score = 10.16
Standard deviation = 4.51
n = 100

The 95% confidence interval for the population mean improvement is:

CI = 9.28 to 11.04

We can be 95% confident that the true average improvement for individuals receiving CBT lies within this range.