# Read in csv

```{r}
data <- read.csv("CA1_Autism_VR_Study_Data_Final.csv")

# Data inspect
head(data)
colnames(data)
```

# Q1. Determine whether the data provided are appropriate for the test(s) available and whether any data cleaning is required.

What do we need to consider:
- Confirm study consisted of 300 patients (M=150, F=150)
- Confirm each group 100 people
- Confirm CBT Group (M=53, F=47)
- Confirm Experimental (VR-based therapy) (M=48, F=52)
- Confirm Control (no CBT, no VR) (M=59, F=41)
- Confirm there is no missed data in any of the rows 

```{r}
# Overall sense check
dim(data)
str(data)
summary(data)
```
```{r}
# Confirm gender distribution (M=150, F=150)
table(data$Gender)

# Confirm group distribution
table(data$Group)

# Confirm gender distribution by group
print(table(data$Gender[data$Group == "CBT"]))
print(table(data$Gender[data$Group == "VR"]))
print(table(data$Gender[data$Group == "Control"]))

```
```{r}
# Check for missing data
sum(is.na(data))
sum(complete.cases(data))
```

- Confirm all of the AQ scores are between 0-50
- Check all of the "Change_Score" = P1_Pre_Score" - "P2_Post_Score"
- Confirm no repeated ids

```{r}
cat(range(data$P1_Pre_Score), "\n")
cat(range(data$P2_Post_Score), "\n")
```

```{r}
calculated_change <- data$P1_Pre_Score - data$P2_Post_Score
correct <- sum(data$Change_Score == calculated_change)
print(correct)
```

```{r}
duplicates <- sum(duplicated(data[[id_column]]))
print(duplicates)
```

## Overview
- The gender distribution of the entire dataset does not match, spec said (M=150, F=150), in actually (M=160, F=140).
- The gender distribution for each group CBT, VR and Control does does spec (M=53, F=47), (M=48, F=52) and (M=59, F=41).
- Confused by the scoring ? need to check with lecturer

# Q2: Formulate three hypothesis tests to be used to compare the effectiveness of the approaches used during the experiment.


Hypothesis Test 1 â€“ Any Therapy vs Control
H0: The mean Change_Score for participants receiving a therapy (CBT or VR) is equal to the mean for the Control group.
H1: Participants receiving a therapy show greater improvement than the Control group.


```{r}
# 1) Create the column TherapyGroup with values Control (Control) and Therapy (CBT or VR)
data$TherapyGroup <- ifelse(data$Group == "Control", "Control", "Therapy")
print(table(data$TherapyGroup))

# 2) Calculate mean for therapy and mean for control
mean_therapy <- mean(data$Change_Score[data$TherapyGroup == "Therapy"], na.rm = TRUE)
mean_control <- mean(data$Change_Score[data$TherapyGroup == "Control"], na.rm = TRUE)

cat("Mean Therapy:", round(mean_therapy, 3), "\n")
cat("Mean Control:", round(mean_control, 3), "\n")

```
## Overview
-A new variable TherapyGroup was created to compare participants who received any therapy (CBT or VR) with those in the Control group.
-The distribution of the new groups is: Therapy = 200 participants, Control = 100 participants.
-The mean improvement (Change_Score) for the Therapy group is 14.795, while the mean improvement for the Control group is 0.01.
-This shows that participants who received CBT or VR improved much more than those who received no treatment.Hypothesis 1 is true